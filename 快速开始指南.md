# UIPS 快速开始指南

## 5 分钟快速启动

### 第 1 步：启动后端 API
```bash
cd src/UIPS.API
dotnet run
```
✅ 看到 `Now listening on: https://localhost:7149` 表示启动成功

### 第 2 步：启动前端客户端（新终端）
```bash
cd src/UIPS.Client
dotnet run
```
✅ 会自动打开登录窗口

### 第 3 步：注册账号
1. 在登录窗口点击"注册"按钮
2. 输入用户名和密码（至少 6 位）
3. 点击"注册"
4. 注册成功后自动跳转到登录界面

### 第 4 步：登录系统
1. 输入刚才注册的用户名和密码
2. 点击"登录"
3. 登录成功后进入仪表盘

### 第 5 步：上传图片
1. 在仪表盘点击"上传图片"按钮
2. 选择图片文件（支持 jpg, png 等格式）
3. 上传成功后图片会显示在列表中

### 第 6 步：选择图片
1. 点击图片下方的"选择"按钮
2. 按钮会变成"取消选择"
3. 切换到"我的收藏"标签页查看已选择的图片

## 创建管理员账号

### 方法 1：使用数据库工具
1. 使用 DB Browser for SQLite 打开 `src/UIPS.API/uips.db`
2. 执行 SQL：
```sql
UPDATE Users SET Role = 'Admin' WHERE UserName = '你的用户名';
```
3. 重新登录即可看到管理员面板

### 方法 2：使用命令行
```bash
cd src/UIPS.API
sqlite3 uips.db "UPDATE Users SET Role = 'Admin' WHERE UserName = '你的用户名';"
```

## 管理员功能

登录管理员账号后：
1. 左侧导航栏会出现"管理员面板"按钮
2. 点击进入管理员面板
3. 可以查看系统统计、管理用户、管理图片

### 管理员面板功能
- **系统统计**：查看用户数、管理员数、图片数、收藏数
- **用户管理**：切换用户角色、删除用户、重置密码
- **图片管理**：查看所有图片、批量删除

## 常用操作

### 上传图片
1. 仪表盘 → 上传图片按钮
2. 选择文件 → 确认上传

### 选择图片
1. 仪表盘 → 图片列表
2. 点击"选择"按钮

### 查看收藏
1. 仪表盘 → "我的收藏"标签页

### 删除图片
1. 仪表盘 → 图片列表
2. 点击"删除"按钮（只能删除自己上传的图片）

### 分页浏览
1. 使用底部的"上一页"/"下一页"按钮
2. 或选择每页显示数量（6/12/24/48）

## 项目结构

```
UIPS/
├── src/
│   ├── UIPS.API/          # 后端 API（端口 7149）
│   └── UIPS.Client/       # 前端客户端
├── tests/
│   └── UIPS.API.Tests/    # 单元测试
└── *.md                   # 文档
```

## 技术栈

- **后端**：ASP.NET Core 8.0 Web API + Entity Framework Core + SQLite
- **前端**：WPF .NET 8.0 + MVVM + Refit + Material Design
- **认证**：JWT Token
- **密码**：BCrypt 加密

## 默认配置

- **后端地址**：https://localhost:7149
- **数据库**：SQLite (src/UIPS.API/uips.db)
- **图片存储**：数据库（Base64 格式）
- **Token 过期**：7 天

## 故障排查

### 问题 1：后端启动失败
**错误**：端口被占用
**解决**：修改 `src/UIPS.API/appsettings.json` 中的端口号

### 问题 2：前端无法连接后端
**错误**：An error occurred while sending the request
**解决**：
1. 确认后端已启动
2. 检查 `src/UIPS.Client/App.xaml.cs` 中的 `apiUrl` 是否正确

### 问题 3：SSL 证书错误
**错误**：The SSL connection could not be established
**解决**：代码中已配置忽略 SSL 证书验证（开发环境）

### 问题 4：登录失败
**错误**：用户名或密码错误
**解决**：
1. 确认用户名和密码正确
2. 检查数据库中是否存在该用户

### 问题 5：管理员面板不显示
**原因**：用户角色不是 Admin
**解决**：按照上面的方法创建管理员账号

## 测试账号建议

创建以下测试账号：
1. **管理员**：admin / admin123
2. **普通用户 1**：user1 / user123
3. **普通用户 2**：user2 / user123

## 开发工具推荐

- **IDE**：Visual Studio 2022 或 JetBrains Rider
- **数据库工具**：DB Browser for SQLite
- **API 测试**：Postman 或使用项目中的 `UIPS.API.http`
- **Git 客户端**：GitHub Desktop 或命令行

## 相关文档

- **代码优化总结.md** - 代码优化记录
- **分页功能实现说明.md** - 分页功能详解
- **管理员功能实现说明.md** - 管理员功能详解
- **管理员功能测试指南.md** - 测试步骤
- **DTO说明文档.md** - DTO 模式详解
- **项目完成总结.md** - 项目总结
- **FinalLab.md** - 实验要求

## 下一步

1. ✅ 启动项目并测试基本功能
2. ✅ 创建管理员账号并测试管理功能
3. ✅ 阅读相关文档了解实现细节
4. ✅ 准备答辩演示

## 联系方式

如有问题，请查看项目文档或检查代码注释。所有代码都有详细的中文注释。

---

**祝你使用愉快！** 🎉
