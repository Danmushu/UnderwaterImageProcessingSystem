# 🚀 立即运行指南

所有问题已修复，项目现在可以正常运行！

## ✅ 已修复的问题

1. **AdminViewModel 依赖注入问题** - 已将主构造函数改为传统构造函数
2. **MainWindow 控件访问问题（第一次）** - 已调整 InitializeComponent() 调用顺序
3. **MainWindow 控件访问问题（第二次）** - 使用 Loaded 事件延迟初始化

## 🎯 快速启动（3 步）

### 步骤 1：启动后端 API

打开终端 1：
```bash
cd src/UIPS.API
dotnet run
```

等待看到：
```
Now listening on: https://localhost:7149
```

### 步骤 2：启动前端客户端

打开终端 2：
```bash
cd src/UIPS.Client
dotnet run
```

会自动弹出登录窗口。

### 步骤 3：注册并登录

1. 点击"注册"按钮
2. 输入用户名和密码（密码至少 6 位）
3. 注册成功后登录

## 🔧 创建管理员账号

### 方法 1：使用 SQLite 命令行

```bash
cd src/UIPS.API
sqlite3 uips.db "UPDATE Users SET Role = 'Admin' WHERE UserName = '你的用户名';"
```

### 方法 2：使用 DB Browser for SQLite

1. 下载并安装 [DB Browser for SQLite](https://sqlitebrowser.org/)
2. 打开 `src/UIPS.API/uips.db`
3. 切换到"执行 SQL"标签
4. 执行：
```sql
UPDATE Users SET Role = 'Admin' WHERE UserName = '你的用户名';
```
5. 点击"写入变更"

### 方法 3：临时修改注册代码

在 `src/UIPS.API/Controllers/AuthController.cs` 的 `Register` 方法中：

```csharp
var user = new User
{
    UserName = dto.UserName,
    PasswordHash = BCrypt.Net.BCrypt.HashPassword(dto.Password),
    Role = "Admin"  // 临时改为 Admin
};
```

注册一个账号后，记得改回 `"User"`。

## 📋 功能测试清单

### 基础功能
- [ ] 用户注册
- [ ] 用户登录
- [ ] 上传图片
- [ ] 浏览图片（分页）
- [ ] 选择/取消选择图片
- [ ] 查看我的收藏
- [ ] 删除自己的图片

### 管理员功能（需要先创建管理员账号）
- [ ] 查看管理员面板按钮（左侧导航栏）
- [ ] 查看系统统计信息
- [ ] 查看用户列表（分页）
- [ ] 切换用户角色（User ↔ Admin）
- [ ] 删除用户
- [ ] 重置用户密码
- [ ] 查看所有图片（含所有者信息）
- [ ] 批量删除图片

## 🎨 界面预览

### 登录界面
- Material Design 风格
- 用户名和密码输入框
- 登录和注册按钮

### 仪表盘
- 图片网格展示（支持 6/12/24/48 张/页）
- 上传图片按钮
- 选择/取消选择按钮
- 删除按钮
- 分页控件（上一页/下一页）
- "我的收藏"标签页

### 管理员面板（仅管理员可见）
- 系统统计卡片（4 个指标）
- 用户管理标签页
  - 用户列表（ID、用户名、角色）
  - 操作按钮（切换角色、删除、重置密码）
  - 分页控件
- 图片管理标签页
  - 图片列表（缩略图、文件名、所有者）
  - 多选复选框
  - 批量删除按钮
  - 分页控件

## 🐛 常见问题

### Q1: 后端启动失败 - 端口被占用
**解决：** 修改 `src/UIPS.API/appsettings.json` 中的端口号

### Q2: 前端无法连接后端
**解决：** 
1. 确认后端已启动
2. 检查 `src/UIPS.Client/App.xaml.cs` 中的 `apiUrl`

### Q3: SSL 证书错误
**解决：** 代码已配置忽略 SSL 验证（开发环境）

### Q4: 管理员面板不显示
**解决：** 确认用户角色是 "Admin"（区分大小写）

### Q5: 图片上传失败
**解决：** 检查图片格式（支持 jpg, png, gif, bmp）

## 📚 相关文档

- **快速开始指南.md** - 5 分钟快速启动
- **管理员功能测试指南.md** - 详细测试步骤
- **问题修复记录.md** - 已修复问题的详细说明
- **项目完成总结.md** - 项目整体情况
- **DTO说明文档.md** - DTO 模式详解

## 🎉 项目状态

✅ 所有代码编译通过
✅ 所有已知问题已修复
✅ 基础功能 100% 完成
✅ 管理员功能完整实现
✅ 文档完善

**项目可以正常运行和演示！**

## 💡 使用建议

1. **首次运行**：先注册一个普通用户测试基础功能
2. **管理员测试**：创建管理员账号后测试管理功能
3. **多用户测试**：注册多个用户，上传不同图片，测试权限隔离
4. **性能测试**：上传大量图片测试分页性能

## 🔗 技术栈

- **后端**：ASP.NET Core 8.0 + EF Core + SQLite + JWT + BCrypt
- **前端**：WPF .NET 8.0 + MVVM + Refit + Material Design
- **架构**：前后端分离 + RESTful API

## 📞 需要帮助？

查看项目中的 Markdown 文档，所有代码都有详细的中文注释。

---

**祝你使用愉快！** 🎊
