# UIPS 项目待优化事项

## 一、功能体验优化

### 1.1 上传后自动刷新图片列表
- **当前问题**：上传成功后只刷新文件名列表，图片显示区域没有自动更新
- **优化方案**：在 `UploadFileAsync` 和 `UploadMultipleFilesAsync` 方法末尾调用 `LoadImagesAsync()`
- **优先级**：高

### 1.2 删除图片后更新分页信息
- **当前问题**：删除图片后 `TotalCount` 没有同步减少，分页信息显示不准确
- **优化方案**：在 `DeleteImageAsync` 成功后更新 `TotalCount` 和 `TotalPages`
- **优先级**：高

### 1.3 预览弹窗支持键盘操作
- **当前问题**：预览弹窗只能点击关闭按钮关闭
- **优化方案**：支持 ESC 键关闭预览，支持左右方向键切换图片
- **优先级**：中

### 1.4 图片加载状态指示
- **当前问题**：加载图片时没有 loading 提示，用户不知道是否在加载
- **优化方案**：添加 `IsLoading` 属性，显示加载动画
- **优先级**：中

### 1.5 批量操作功能
- **当前问题**：只能单张删除图片
- **优化方案**：支持多选图片后批量删除、批量下载
- **优先级**：低

---

## 二、代码质量优化

### 2.1 API BaseUrl 硬编码
- **当前问题**：`https://localhost:7149` 在多处硬编码
- **涉及文件**：`DashboardViewModel.cs`、`AdminViewModel.cs`、`App.xaml.cs`
- **优化方案**：提取到 `appsettings.json` 或专门的配置类中
- **优先级**：高

### 2.2 重复的 JSON 解析代码
- **当前问题**：`GetJsonInt`、`GetJsonLong`、`GetJsonString` 等方法在多个 ViewModel 中重复定义
- **优化方案**：抽取到公共的 `JsonHelper` 工具类
- **优先级**：中

### 2.3 使用强类型 DTO 替代 dynamic
- **当前问题**：前端大量使用 `dynamic` 类型，缺乏类型安全
- **优化方案**：定义前端 DTO 类，使用 Refit 的强类型返回
- **优先级**：中

### 2.4 异常处理细化
- **当前问题**：所有异常统一处理，用户无法区分错误类型
- **优化方案**：区分网络错误、认证错误、业务错误，给出不同提示
- **优先级**：低

---

## 三、安全性优化

### 3.1 Token 过期处理
- **当前问题**：JWT Token 过期后没有自动刷新或提示重新登录
- **优化方案**：
  - 方案A：实现 Refresh Token 机制
  - 方案B：检测 401 响应后自动跳转登录页
- **优先级**：高

### 3.2 密码强度验证
- **当前问题**：注册时没有密码复杂度要求
- **优化方案**：前后端都添加密码强度验证（长度、大小写、数字、特殊字符）
- **优先级**：中

### 3.3 敏感操作日志
- **当前问题**：管理员操作（删除用户、重置密码）没有记录日志
- **优化方案**：添加操作日志表，记录敏感操作
- **优先级**：低

---

## 四、UI/UX 优化

### 4.1 空状态提示优化
- **当前问题**：没有图片时只显示简单文字
- **优化方案**：添加引导性图标和操作按钮
- **优先级**：低

### 4.2 操作反馈优化
- **当前问题**：部分操作成功/失败只在状态栏显示
- **优化方案**：使用 Snackbar 或 Toast 提示
- **优先级**：中

### 4.3 响应式布局
- **当前问题**：图片卡片固定宽度，窗口变化时布局不够灵活
- **优化方案**：根据窗口宽度动态调整每行显示数量
- **优先级**：低

### 4.4 深色/浅色主题切换
- **当前问题**：只有深色主题
- **优化方案**：添加主题切换功能
- **优先级**：低

---

## 五、性能优化

### 5.1 图片懒加载
- **当前问题**：一次性加载当前页所有图片
- **优化方案**：实现虚拟化列表，只渲染可见区域的图片
- **优先级**：低（数据量大时考虑）

### 5.2 图片缓存
- **当前问题**：每次切换页面都重新请求图片
- **优化方案**：实现本地图片缓存机制
- **优先级**：低

### 5.3 缩略图优化
- **当前问题**：列表显示使用原图
- **优化方案**：后端生成缩略图，列表使用缩略图，预览使用原图
- **优先级**：中

---

## 六、建议优先处理

| 序号 | 优化项 | 优先级 | 预计工作量 |
|------|--------|--------|-----------|
| 1 | 上传后自动刷新图片列表 | 高 | 5分钟 |
| 2 | 删除图片后更新分页信息 | 高 | 5分钟 |
| 3 | API BaseUrl 配置化 | 高 | 15分钟 |
| 4 | 预览弹窗 ESC 关闭 | 中 | 10分钟 |
| 5 | Token 过期处理 | 高 | 30分钟 |
